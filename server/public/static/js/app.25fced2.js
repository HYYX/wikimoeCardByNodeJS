webpackJsonp([2],{"+BTi":function(t,e){},0:function(t,e){},"6ERS":function(t,e){},EfxW:function(t,e){},"J+GG":function(t,e){},NHnr:function(t,e,a){"use strict";function s(t){a("wB98")}function r(t){a("RX3B")}function o(t){a("mWqf")}function i(t){a("J+GG")}Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),c=a.n(n),l=(a("+BTi"),a("lRwf")),d=a.n(l),m=a("SJI6"),u=a.n(m),f={},g={},_={namespaced:!0,state:f,mutations:g},h=new u.a.Store({modules:{app:_}}),p=h,v=a("pRNm"),w=a.n(v),C=a("W3Iv"),k=a.n(C),b=a("//Fk"),y=a.n(b),$=a("OMN4"),x=a.n($),I=a("bOdI"),S=a.n(I),L=a("zL8q"),T=a.n(L),D=function(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)},U=function(t){return/^\d{4,8}$/.test(t)},P=function(t){return/^[\u4E00-\u9FA5\u0800-\u4e00A-Za-z0-9_]{2,8}$/.test(t)},E=function(t,e){return(t+"").length>e?t+"":(Array(e).join("0")+t).slice(-e)},R=function(t){return/^[A-Za-z0-9]{32}$/.test(t)},N=function(t,e,a){for(var s=t.length,r=[],o=[],i=0;i<s;i++)r[i]=new y.a(function(e,a){o[i]=new Image,o[i].src=t[i],o[i].onload=function(){e("ok")},o[i].onerror=function(){a("err")}});y.a.all(r).then(function(t){console.log(t),e("img all ok")}).catch(function(t){a(t)})},M=0,B=void 0,V=function(){B=L.Loading.service({background:"rgba(255,255,255,0)",text:"努力加载中...",spinner:"el-icon-loading"})},j=function(){B.close()},z=function(){0===M&&V(),M+=1},F=function(){M<=0||0===(M-=1)&&j()},q=function(t){return x.a.create(t)}({baseURL:"/api"});q.defaults.timeout=3e4,q.interceptors.request.use(function(t){return z(),t},function(t){return F(),y.a.reject(t)}),q.interceptors.response.use(function(t){return F(),t},function(t){return F(),Object(L.Message)({message:"服务器连接发送错误，请稍后再试！",type:"error"}),y.a.reject(t)});var H=function(t){return S()({login:function(e){return t.post("login",e)},dailycard:function(e){return t.post("dailycard",e)},reg:function(e){return t.post("reg",e)},searchcard:function(e){return t.post("searchcard",e)},sendmail:function(e){return t.post("sendmail",e)},searchlog:function(e){return t.post("searchlog",e)}},"login",function(e){return t.post("login",e)})}(q),G={props:{trigger:{type:String,default:"click"},value:{type:Boolean,default:!0},direction:{type:String,default:"row"},cardSrc:{type:String,default:""}},data:function(){return{surface:!0}},watch:{value:function(t){console.log(this.value),"custom"==this.trigger&&this.fn_reserve_action(t)}},methods:{fn_reserve_action:function(t){var e="row"==this.direction?["rotateY(180deg)","rotateY(0deg)","rotateY(-180deg)"]:["rotateX(180deg)","rotateX(0deg)","rotateX(-180deg)"];this.$refs.cardz.style.transform=t?e[0]:e[1],this.$refs.cardf.style.transform=t?e[1]:e[2]},eve_cardres_click:function(){"click"==this.trigger&&(this.fn_reserve_action(this.surface),this.surface=!this.surface)},eve_cardres_msover:function(){"hover"==this.trigger&&this.fn_reserve_action(!0)},eve_cardres_msout:function(){"hover"==this.trigger&&this.fn_reserve_action(!1)}}},O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-3d",on:{click:t.eve_cardres_click,mouseover:t.eve_cardres_msover,mouseout:t.eve_cardres_msout}},[a("div",{ref:"cardz",staticClass:"card card-z"},[t._t("cz")],2),t._v(" "),a("div",{ref:"cardf",class:["card","row"==t.direction?"card-f-y":"card-f-x"]},[t._t("cf",[""!==t.cardSrc?a("img",{staticClass:"wm_getcard_img",attrs:{width:"100%",height:"100%",src:t.cardSrc}}):t._e()])],2)])},W=[],J={render:O,staticRenderFns:W},X=J,Y=a("VU/8"),A=s,Z=Y(G,X,!1,A,null,null),K=Z.exports,Q={data:function(){return{captchaSrc:"/api/captcha?time="+(new Date).getTime(),routPath:null,loginShow:!1,form:{email:"",password:"",captcha:"",remPass:!1}}},mounted:function(){this.getRememberEmail()},methods:{goHome:function(){this.$router.push({path:"/"})},cancelLoginShow:function(){this.loginShow=!1,this.routPath=null,this.form={email:"",password:"",captcha:"",remPass:!1}},goLogin:function(){var t=this,e={email:this.form.email,password:this.form.password,captcha:this.form.captcha,remPass:Number(this.form.remPass)};H.login(e).then(function(e){if(console.log(e),0==e.data.code)t.$message.error(e.data.msg),t.captchaUpdata();else if(1==e.data.code){var a=e.data;t.form.remPass?localStorage.setItem("token",a.token):sessionStorage.setItem("token",a.token),t.goLink()}})},getRememberEmail:function(){var t=window.localStorage;t.getItem("wikimoeEmail")&&(this.form.email=t.getItem("wikimoeEmail"))},emailToLowerCase:function(){this.form.email=this.form.email.toLowerCase()},captchaUpdata:function(){this.captchaSrc="/api/captcha?time="+(new Date).getTime()},login:function(t){this.routPath=t,(sessionStorage.getItem("token")?sessionStorage.getItem("token"):localStorage.getItem("token"))?this.goLink():(this.loginShow=!0,this.captchaSrc="/api/captcha?time="+(new Date).getTime())},goLink:function(){if(console.log(this.routPath),!this.routPath)return!1;this.$router.push({path:this.routPath})}}},tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"wm_card_menu_body"},["/"!=t.$route.path?a("div",{staticClass:"wm_card_menu_box",on:{click:function(e){return t.goHome()}}},[a("div",{staticClass:"wm_card_menu_ico"}),t._v(" "),a("div",{staticClass:"wm_card_menu_text"},[t._v("首页")])]):t._e(),t._v(" "),"/demining"!=t.$route.path?a("div",{staticClass:"wm_card_menu_box",on:{click:function(e){return t.login("/demining")}}},[a("div",{staticClass:"wm_card_menu_ico"}),t._v(" "),a("div",{staticClass:"wm_card_menu_text"},[t._v("矿场")])]):t._e(),t._v(" "),t._m(0),t._v(" "),t._m(1)]),t._v(" "),a("el-dialog",{staticClass:"reg_code_dialog",attrs:{title:"请登录","before-close":t.cancelLoginShow,visible:t.loginShow,width:"100%"},on:{"update:visible":function(e){t.loginShow=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{attrs:{placeholder:"请输入邮箱地址"},on:{input:t.emailToLowerCase},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{"show-password":"",placeholder:"请输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"验证码"}},[a("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:t.form.captcha,callback:function(e){t.$set(t.form,"captcha",e)},expression:"form.captcha"}},[a("template",{slot:"append"},[a("img",{staticClass:"reg_code_img",attrs:{src:t.captchaSrc},on:{click:t.captchaUpdata}})])],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"记住密码"}},[a("el-switch",{model:{value:t.form.remPass,callback:function(e){t.$set(t.form,"remPass",e)},expression:"form.remPass"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.cancelLoginShow()}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.goLogin()}}},[t._v("登录")])],1)],1)],1)},et=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wm_card_menu_box"},[a("div",{staticClass:"wm_card_menu_ico"}),t._v(" "),a("div",{staticClass:"wm_card_menu_text"},[t._v("商店")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wm_card_menu_box"},[a("div",{staticClass:"wm_card_menu_ico"}),t._v(" "),a("div",{staticClass:"wm_card_menu_text"},[t._v("捐赠")])])}],at={render:tt,staticRenderFns:et},st=at,rt=a("VU/8"),ot=rt(Q,st,!1,null,null,null),it=ot.exports,nt=a("NC6I"),ct=a.n(nt),lt={data:function(){return{shareDialog:!1,shareUrl:"",logListTotal:0,logPage:1,logList:[],remEmail:!1,email:"",getCardList:["","",""],cardIsRotate:[!1,!1,!1],seled:!1,restartDisabled:!0,userCard:null,userCardCache:null,cardPage:1,cardTotle:0,nowUserInfo:{tx:"",score:0,level:0,cardCol:0,nickName:"",cardCount:0,md5:""}}},components:{rotate3DCard:K,menuView:it},filters:{cardStarText:function(t){return t<=3?"虽然卡牌星级不高，但是我也很喜欢！":4==t?"不好不差，证明我既不是非洲人也不是欧洲人。":5==t?"运气不错，距离欧皇就差一点点。":6==t?"欧气满满，欧耶~":""},capitalize:function(t){var e=new Date(parseInt(1e3*t));return[e.getFullYear(),e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,e.getDate()<10?"0"+e.getDate():e.getDate()].join("-")+"  "+[e.getHours()<10?"0"+e.getHours():e.getHours(),e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()].join(":")}},mounted:function(){this.getRememberEmail(),this.getLog(1),this.setCardScroll(),this.urlUserInfo()},methods:{copyUrl:function(){var t=this;this.$copyText(this.shareUrl).then(function(e){t.$message({message:"复制分享地址成功！",type:"success"})},function(t){this.$message.error("复制失败，请手动复制！"),console.log(t)})},openShare:function(){this.shareUrl=window.location.origin+"?md5="+this.nowUserInfo.md5,this.shareDialog=!0},urlUserInfo:function(){var t=this.$route.query.md5;void 0!==t&&(this.getUserCard(t,!1),this.$router.replace({path:"/"}))},setCardScroll:function(){var t=this.$refs.cardListParents.clientWidth,e=this.$refs.cardListBody.clientWidth;console.log(t),e>t&&(this.$refs.cardListParents.scrollLeft=(e-t)/2)},getLog:function(t){var e=this;H.searchlog({page:t}).then(function(a){console.log(a),0==a.data.code?e.$message.error(a.data.msg):1==a.data.code&&(e.logList=a.data.data,e.logListTotal=a.data.total,e.logPage=t)})},openImg:function(t){this.$alert('<div class="watch_img"><img src="'+t+'" /></div>',"查看卡牌",{dangerouslyUseHTMLString:!0})},scrollToTop:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments[1];if(!a)return document.body.scrollTop=document.documentElement.scrollTop=e,e;var s=a/20,r=document.body.scrollTop+document.documentElement.scrollTop,o=(e-r)/s,i=setInterval(function(){s>0?(s--,t.scrollToTop(r+=o)):clearInterval(i)},20)},logPageChange:function(t){this.getLog(t)},cardPageChange:function(t,e){for(var a=this,s=this.userCardCache.slice(20*(t-1),20*t),r=[],o=0;o<s.length;o++){var i="/static/img/"+E(s[o][0],4)+".jpg";r.push(i)}z(),new y.a(function(t,e){N(r,t,e)}).then(function(t){a.userCard=null,setTimeout(function(){e||a.scrollToTop(450,200),F(),a.userCard=s},300)}).catch(function(t){console.log(t),F(),a.$message.error("图片资源加载失败")})},PrefixInteger_:function(t,e){return E(t,e)},watchUserCard:function(t){var e=this;setTimeout(function(){e.getUserCard(t)},0)},getUserCard:function(t,e){var a=this;if(!R(t))return this.$message.error("用户信息有误！"),!1;H.searchcard({md5:t}).then(function(t){if(console.log(t),0==t.data.code)a.$message.error(t.data.msg);else if(1==t.data.code){var s=t.data;t.data.card?(a.userCardCache=k()(t.data.card),a.userCardCache.reverse(),a.cardPage=1,a.cardTotle=a.userCardCache.length,a.cardPageChange(1,e),console.log(a.nowUserInfo),a.nowUserInfo={tx:"https://cdn.v2ex.com/gravatar/"+s.md5+"?s=100&d=mm&r=g&d=robohash",score:s.score,level:s.level,cardCol:a.cardTotle,nickName:s.nickName,cardCount:s.cardCount,md5:s.md5},console.log(a.userCardCache)):a.$message({message:s.nickName+"还没有获得过卡牌呢！",type:"warning"})}})},getRememberEmail:function(){var t=window.localStorage;t.getItem("wikimoeEmail")&&(this.email=t.getItem("wikimoeEmail"),this.remEmail=!0)},rememberEmail:function(){var t=window.localStorage;this.remEmail?t.setItem("wikimoeEmail",this.email):t.removeItem("wikimoeEmail")},restart:function(){var t=this;this.restartDisabled=!0,this.$refs.cardListBody.children[0].classList.remove("no-selectedcard"),this.$refs.cardListBody.children[1].classList.remove("no-selectedcard"),this.$refs.cardListBody.children[2].classList.remove("no-selectedcard"),this.cardIsRotate=[!1,!1,!1],this.userCard=null,this.userCardCache=null,this.cardPage=1,this.cardTotle=0,this.nowUserInfo={tx:"",score:0,level:0,cardCol:0,nickName:""},setTimeout(function(){t.getCardList=["","",""],t.seled=!1},800)},getDailyCard:function(t){var e=this;return!this.seled&&(D(this.email)?(console.log(t),void H.dailycard({email:this.email,sel:t}).then(function(t){console.log(t);var a=ct()(e.email);if(0==t.data.code)e.$message.error(t.data.msg);else if(1==t.data.code){e.rememberEmail();var s=t.data,r=["/static/img/"+E(s.cardChoiseList[0],4)+".jpg","/static/img/"+E(s.cardChoiseList[1],4)+".jpg","/static/img/"+E(s.cardChoiseList[2],4)+".jpg"];z(),new y.a(function(t,e){N(r,t,e)}).then(function(t){F(),e.seled=!0,e.getUserCard(a,!0),e.$set(e.getCardList,0,r[0]),e.$set(e.getCardList,1,r[1]),e.$set(e.getCardList,2,r[2]),e.$set(e.cardIsRotate,s.choiseIndex,!0);var o="";o=s.leftGetChance>0?"抽卡成功，今天还剩余"+s.leftGetChance+"次抽卡机会！":"抽卡成功，这已经是您今天最后一次抽卡机会了！",e.$message({message:o,type:"success"}),e.getLog(1);for(var i=0;i<3;i++)!function(t){t!==s.choiseIndex&&(setTimeout(function(){e.$refs.cardListBody.children[t].classList.add("no-selectedcard"),e.restartDisabled=!1},950),setTimeout(function(){e.$set(e.cardIsRotate,t,!0)},800))}(i)}).catch(function(t){console.log(t),F(),e.$message.error("图片资源加载失败")})}else 2==t.data.code?e.$confirm("您尚未注册，是否进入注册页？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push({path:"/reg",query:{adr:btoa(e.email)}})}).catch(function(){}):3==t.data.code&&(e.$message.error(t.data.msg),e.getUserCard(a,!0))})):(this.$message.error("邮箱格式不正确！"),!1))}}},dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common_body"},[a("h5",{staticClass:"wm_card_chiose_title"},[t._v("欢迎来到维基萌抽卡")]),t._v(" "),a("div",{staticClass:"wm_card_email_body"},[a("transition",{attrs:{name:"el-fade-in-linear"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.seled,expression:"!seled"}],staticClass:"wm_card_email_input_body"},[a("el-input",{staticClass:"wm_card_email",attrs:{placeholder:"请先输入邮箱地址再点击卡片"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)]),t._v(" "),a("transition",{attrs:{name:"el-fade-in-linear"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.seled,expression:"seled"}],staticClass:"wm_card_restart_body"},[a("el-button",{attrs:{type:"primary",disabled:t.restartDisabled},on:{click:t.restart}},[t._v("重新抽卡")])],1)])],1),t._v(" "),a("transition",{attrs:{name:"el-fade-in-linear"}},[a("div",{staticClass:"wm_card_remember_body"},[a("el-checkbox",{model:{value:t.remEmail,callback:function(e){t.remEmail=e},expression:"remEmail"}},[t._v("抽卡并保存邮箱地址")])],1)]),t._v(" "),a("div",{ref:"cardListParents",staticClass:"cardList"},[a("div",{ref:"cardListBody",staticClass:"cardList_body"},[a("div",{staticClass:"card_list",class:t.seled?"selectedcard":"",on:{click:function(e){return t.getDailyCard(0)}}},[a("rotate3DCard",{attrs:{trigger:"custom",direction:"row",cardSrc:t.getCardList[0]},model:{value:t.cardIsRotate[0],callback:function(e){t.$set(t.cardIsRotate,0,e)},expression:"cardIsRotate[0]"}},[t._t("cz"),t._v(" "),t._t("cf")],2)],1),t._v(" "),a("div",{staticClass:"card_list",class:t.seled?"selectedcard":"",on:{click:function(e){return t.getDailyCard(1)}}},[a("rotate3DCard",{attrs:{trigger:"custom",direction:"row",cardSrc:t.getCardList[1]},model:{value:t.cardIsRotate[1],callback:function(e){t.$set(t.cardIsRotate,1,e)},expression:"cardIsRotate[1]"}},[t._t("cz"),t._v(" "),t._t("cf")],2)],1),t._v(" "),a("div",{staticClass:"card_list",class:t.seled?"selectedcard":"",on:{click:function(e){return t.getDailyCard(2)}}},[a("rotate3DCard",{attrs:{trigger:"custom",direction:"row",cardSrc:t.getCardList[2]},model:{value:t.cardIsRotate[2],callback:function(e){t.$set(t.cardIsRotate,2,e)},expression:"cardIsRotate[2]"}},[t._t("cz"),t._v(" "),t._t("cf")],2)],1)])]),t._v(" "),a("div",{staticClass:"wm_user_info_body"},[a("el-collapse-transition",[t.userCard?a("div",{staticClass:"wm_mycard_list"},[a("h5",{staticClass:"wm_card_chiose_title"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击分享卡牌信息",placement:"top","hide-after":3e3}},[a("img",{staticClass:"wm_title_info_avatar_pic",attrs:{src:t.nowUserInfo.tx,width:"45",height:"45"},on:{click:function(e){return t.openShare()}}})]),t._v(" "),a("br"),t._v(" "),a("span",[t._v(t._s(t.nowUserInfo.nickName)+"的当前信息")])],1),t._v(" "),a("table",{staticClass:"wm_user_info_table"},[a("thead",[a("tr",[a("th",[t._v("等级")]),t._v(" "),a("th",[t._v("竞技点")]),t._v(" "),a("th",[t._v("收集率")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticClass:"wm_user_level"},[t._v(t._s(t.nowUserInfo.level))]),t._v(" "),a("td",{staticClass:"wm_user_score"},[t._v(t._s(t.nowUserInfo.score))]),t._v(" "),a("td",{staticClass:"wm_user_getcard_count"},[t._v(t._s(t.nowUserInfo.cardCol)+"/"+t._s(t.nowUserInfo.cardCount))])])])]),t._v(" "),a("sequential-entrance",{attrs:{delay:"100",tag:"div"}},t._l(t.userCard,function(e,s){return a("div",{key:s+1,staticClass:"wm_getcard_box"},[a("img",{staticClass:"wm_getcard_img",attrs:{src:"/static/img/"+t.PrefixInteger_(e[0],4)+".jpg"},on:{click:function(a){t.openImg("/static/img/"+t.PrefixInteger_(e[0],4)+".jpg")}}}),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"wm_card_nums"},[t._v("×"+t._s(e[1]))])])}),0),t._v(" "),a("el-pagination",{staticClass:"my_card_page",attrs:{small:"",layout:"prev, pager, next",total:t.cardTotle,"current-page":t.cardPage,"page-size":20},on:{"current-change":t.cardPageChange,"update:currentPage":function(e){t.cardPage=e},"update:current-page":function(e){t.cardPage=e}}})],1):t._e()])],1),t._v(" "),a("el-dialog",{staticClass:"reg_code_dialog",attrs:{title:"分享卡牌信息",visible:t.shareDialog,width:"100%"},on:{"update:visible":function(e){t.shareDialog=e}}},[a("el-input",{staticClass:"copyShareUrl",attrs:{disabled:""},model:{value:t.shareUrl,callback:function(e){t.shareUrl=e},expression:"shareUrl"}}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.shareDialog=!1}}},[t._v("关闭")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.copyUrl}},[t._v("复制")])],1)],1),t._v(" "),a("menuView"),t._v(" "),t.logList.length>0?a("div",{staticClass:"wm_card_get_list_body"},[a("h5",{staticClass:"wm_card_chiose_title"},[t._v("最新动态")]),t._v(" "),a("div",{staticClass:"wm_card_get_list_item_body"},[a("transition-group",{attrs:{name:"el-fade-in-linear"}},t._l(t.logList,function(e,s){return a("div",{key:s+1,staticClass:"wm_card_get_list_item"},[a("div",{staticClass:"wm_card_get_list_avatar",on:{click:function(a){return t.watchUserCard(e.md5)}}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"查看"+e.nickName+"的卡牌",placement:"top","hide-after":3e3}},[a("img",{staticClass:"wm_card_get_list_avatar_pic",attrs:{src:"https://cdn.v2ex.com/gravatar/"+e.md5+"?s=100&d=mm&r=g&d=robohash",width:"45",height:"45","data-md5":"5e6892e999ca8c85a358d21164167f38"}})])],1),t._v(" "),a("div",{staticClass:"wm_card_get_list_comment"},[a("p",[a("span",{staticClass:"wm_log_name"},[t._v(t._s(e.nickName))]),t._v(" "),a("span",{staticClass:"wm_log_time"},[t._v(t._s(t._f("capitalize")(e.time)))])]),t._v(" "),a("p",["register"==e.type?a("span",[t._v("\n                大家好，我是萌新"+t._s(e.nickName)+"。初来乍到对什么都还很陌生，还恳请大家能够多多指导我怎么抽出六星卡！\n              ")]):t._e(),t._v(" "),"dailyCard"==e.type?a("span",[t._v("\n                我抽中了出自作品《"+t._s(e.data.title)+"》的"+t._s(e.data.star)+"星卡"),a("span",{staticClass:"wm_card_get_list_card_link",class:e.data.star>=6?"wm_six_star_card_shake":"",on:{click:function(a){t.openImg("/static/img/"+t.PrefixInteger_(e.data.cardId,4)+".jpg")}}},[t._v(t._s(e.data.name))]),t._v("。\n                "+t._s(t._f("cardStarText")(e.data.star))+"\n              ")]):t._e()])])])}),0),t._v(" "),a("div",{staticClass:"log_page"},[a("el-pagination",{staticClass:"my_log_page",attrs:{small:"",layout:"prev, pager, next",total:t.logListTotal,"current-page":t.logPage,"page-size":5},on:{"current-change":t.logPageChange,"update:currentPage":function(e){t.logPage=e},"update:current-page":function(e){t.logPage=e}}})],1)],1)]):t._e()],1)},mt=[],ut={render:dt,staticRenderFns:mt},ft=ut,gt=a("VU/8"),_t=gt(lt,ft,!1,null,null,null),ht=_t.exports,pt={data:function(){return{captchaSrc:"/api/captcha?time="+(new Date).getTime(),sending:!1,codeShow:!1,form:{email:"",password:"",code:"",nickName:"",captcha:""}}},mounted:function(){this.$route.query.adr&&(this.form.email=atob(this.$route.query.adr))},methods:{captchaUpdata:function(){this.captchaSrc="/api/captcha?time="+(new Date).getTime()},openEmailDialog:function(){if(!D(this.form.email))return this.$message.error("邮箱格式有误！"),!1;this.captchaSrc="/api/captcha?time="+(new Date).getTime(),this.codeShow=!0},sendEmailCode:function(){var t=this;if(""==this.form.captcha)return this.$message.error("请输入图形验证码！"),!1;this.sending=!0;var e={email:this.form.email,captcha:this.form.captcha,type:"reg"};H.sendmail(e).then(function(e){console.log(e),t.captchaUpdata(),0==e.data.code?t.$message.error(e.data.msg):1==e.data.code&&(t.$message({message:e.data.msg,type:"success"}),t.codeShow=!1),setTimeout(function(){t.sending=!1},500)})},onSubmit:function(){var t=this;if(!D(this.form.email))return this.$message.error("邮箱格式有误！"),!1;if(!U(this.form.password))return this.$message.error("密码必须为4-8位纯数字！"),!1;if(!P(this.form.nickName))return this.$message.error("昵称只能允许为2-8位中英日数字与下划线！"),!1;if(""==this.form.code)return this.$message.error("请输入邮箱验证码！"),!1;var e={email:this.form.email,password:this.form.password,nickName:this.form.nickName,emailCode:this.form.code};H.reg(e).then(function(e){if(console.log(e),0==e.data.code)t.$message.error(e.data.msg);else if(1==e.data.code){e.data;t.$alert("恭喜您，注册成功！","提示",{confirmButtonText:"确定",showClose:!1,callback:function(e){t.$router.push({path:"/"})}})}})},backIndex:function(){this.$router.push({path:"/"})},emailToLowerCase:function(){this.form.email=this.form.email.toLowerCase()}}},vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common_body"},[a("h5",{staticClass:"common_title"},[t._v("注册账号")]),t._v(" "),a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"邮箱地址"}},[a("el-input",{attrs:{placeholder:"请输入邮箱地址"},on:{input:t.emailToLowerCase},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{"show-password":"",placeholder:"请输入4-8位纯数字"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("el-input",{attrs:{placeholder:"昵称格式为2-8位中英日数字下划线"},model:{value:t.form.nickName,callback:function(e){t.$set(t.form,"nickName",e)},expression:"form.nickName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"邮箱验证"}},[a("el-input",{attrs:{placeholder:"请输入邮箱验证码"},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}},[a("el-button",{attrs:{slot:"append"},on:{click:t.openEmailDialog},slot:"append"},[t._v("发送验证码")])],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("注册抽卡")]),t._v(" "),a("el-button",{on:{click:t.backIndex}},[t._v("返回首页")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"reg_code_dialog",attrs:{title:"请输入验证码",visible:t.codeShow,width:"100%"},on:{"update:visible":function(e){t.codeShow=e}}},[a("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:t.form.captcha,callback:function(e){t.$set(t.form,"captcha",e)},expression:"form.captcha"}},[a("template",{slot:"append"},[a("img",{staticClass:"reg_code_img",attrs:{src:t.captchaSrc},on:{click:t.captchaUpdata}})])],2),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.codeShow=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",disabled:t.sending},on:{click:t.sendEmailCode}},[t._v("发送")])],1)],1)],1)},wt=[],Ct={render:vt,staticRenderFns:wt},kt=Ct,bt=a("VU/8"),yt=r,$t=bt(pt,kt,!1,yt,"data-v-1cbefac2",null),xt=$t.exports,It=a("DmT9"),St=a.n(It),Lt={data:function(){return{backFlag:!1,socket:null,mineMap:[],mineInfo:null,selBlock:null,token:sessionStorage.getItem("token")?sessionStorage.getItem("token"):localStorage.getItem("token"),userData:null,min:"--",sec:"--",counter:null}},components:{menuView:it},mounted:function(){var t=this,e=window.location.hostname;this.socket=St.a.connect("//"+e+":3000"),this.socket.on("demining",function(e){console.log(e),1==e.code?t.$message.error(e.msg):0==e.code?(t.mineInfo=e,t.creatMap(e.data)):2==e.code?t.$message({message:"恭喜您挖到了"+e.star+"颗星星！",type:"success"}):4==e.code?t.$message("挖矿尚在冷却中！还剩"+e.nextTime+"秒"):3==e.code?(console.log(123),t.userData=e.userData,clearInterval(t.counter),t.countdown()):403==e.code&&(sessionStorage.removeItem("token"),localStorage.removeItem("token"),t.$alert(e.msg,"提示",{confirmButtonText:"确定",showClose:!1,callback:function(e){t.$router.push({path:"/"})}}))}),this.socket.on("connect",function(){t.$message({message:"已连接服务器！",type:"success"});var e={type:"get",token:t.token};t.socket.emit("demining",e)}),this.socket.on("disconnect",function(){t.backFlag||t.$message.error("服务器连接已断开！")})},methods:{countdown:function(){var t=this,e=Math.round((new Date).getTime()/1e3)+this.userData.nextTime;this.counter=setInterval(function(){var a=e-Math.round((new Date).getTime()/1e3);if(a<=-1)return t.min="00",t.sec="00",void clearInterval(t.counter);var s=a%60,r=Math.floor(a/60),o=Math.floor(r/60);r%=60,o%=60,r<10&&(r="0"+r),o<10&&(o="0"+o),s<10&&(s="0"+s),t.min=r,t.sec=s},1e3)},deminingItemClass:function(t,e,a){var s="",r=e+"_"+a;return t>=0?(s="type_is_opened",9==t&&(s+=" is_wmdmstar")):r==this.selBlock&&(s="selected"),s},openNode:function(t,e,a){if(a>=0)return!1;var s=t+"_"+e;if(s==this.selBlock){var r={type:"open",creatTime:this.mineInfo.data.creatTime,x:t,y:e,token:this.token};this.socket.emit("demining",r),this.selBlock=null}else this.selBlock=s},creatMapInitData:function(t,e){this.mineMap[t][e]={md5:null,num:-1}},creatMap:function(t){this.mineMap=[];for(var e=0;e<t.rows;e++){this.mineMap[e]=[];for(var a=0;a<t.cols;a++)if(t.player){var s=t.player[e+"_"+a];s?this.mineMap[e][a]=s:this.creatMapInitData(e,a)}else this.creatMapInitData(e,a)}console.log(this.mineMap)}},beforeDestroy:function(){this.backFlag=!0,this.socket.close(),clearInterval(this.counter)}},Tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"common_body"},[t.userData?a("div",[a("div",{staticClass:"wm_card_chiose_title"},[a("img",{staticClass:"wm_title_info_avatar_pic",attrs:{src:"https://cdn.v2ex.com/gravatar/"+t.userData.md5+"?s=100&d=mm&r=g&d=robohash",width:"45",height:"45"}}),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"wm_card_demining_star"},[t._v(t._s(t.userData.nickName)+"的星星:"+t._s(t.userData.star))]),t._v(" "),a("div",{staticClass:"wm_card_demining_per_body"},[a("div",{staticClass:"wm_card_demining_time_body"},[a("span",[t._v("冷却:")]),a("span",{staticClass:"wm_card_demining_time_num"},[t._v(t._s(t.min))]),a("span",[t._v("分")]),a("span",{staticClass:"wm_card_demining_time_num"},[t._v(t._s(t.sec))]),a("span",[t._v("秒")])])])])]):t._e(),t._v(" "),a("div",{staticClass:"wm_card_demining_table_box"},[a("table",{staticClass:"wm_card_demining_table"},[a("tbody",t._l(t.mineMap,function(e,s){return a("tr",{key:s},t._l(e,function(e,r){return a("td",{key:r},[a("div",{staticClass:"wm_demining_item",class:t.deminingItemClass(e.num,r,s),on:{click:function(a){return t.openNode(r,s,e.num)}}},[e.num>=0?a("div",[a("span",[t._v(t._s(9==e.num?"★":e.num))]),t._v(" "),a("img",{staticClass:"wm_demining_img",attrs:{src:"https://cdn.v2ex.com/gravatar/"+e.md5+"?s=100&d=mm&r=g&d=robohash",width:"50",height:"50"}})]):t._e()])])}),0)}),0)])]),t._v(" "),a("menuView")],1)])},Dt=[],Ut={render:Tt,staticRenderFns:Dt},Pt=Ut,Et=a("VU/8"),Rt=o,Nt=Et(Lt,Pt,!1,Rt,"data-v-2d8a9cde",null),Mt=Nt.exports,Bt=function(){return a.e(0).then(a.bind(null,"KHiY"))},Vt=new w.a({mode:"history",scrollBehavior:function(t,e,a){return a||(a={x:0,y:0}),a},routes:[{name:"home",path:"/",component:ht},{name:"reg",path:"/reg",component:xt},{name:"demining",path:"/demining",component:Mt},{name:"404",path:"/404",component:Bt},{path:"*",redirect:"/404"}]}),jt=Vt,zt=a("woOf"),Ft=a.n(zt),qt={};qt.install=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!qt.install.installed){qt.install.installed=!0;var a=t;Ft()(x.a.defaults,e),a.$http=x.a,a.prototype.$http=x.a}},window.Vue&&window.Vue.use(qt);var Ht=qt,Gt=(a("tvR6"),{data:function(){return{}}}),Ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},Wt=[],Jt={render:Ot,staticRenderFns:Wt},Xt=Jt,Yt=a("VU/8"),At=i,Zt=Yt(Gt,Xt,!1,At,"data-v-3076ff55",null),Kt=Zt.exports,Qt=(a("u7k/"),a("EfxW"),a("a2gP")),te=(a("6ERS"),a("wvfG")),ee=a.n(te);d.a.use(ee.a),d.a.use(Qt.a),d.a.use(T.a),d.a.use(Ht);var ae=new d.a(c()({},Kt,{router:jt,store:p}));document.addEventListener("DOMContentLoaded",function(){ae.$mount("#app")})},OMN4:function(t,e){t.exports=axios},RX3B:function(t,e){},SJI6:function(t,e){t.exports=Vuex},lRwf:function(t,e){t.exports=Vue},mWqf:function(t,e){},pRNm:function(t,e){t.exports=VueRouter},tvR6:function(t,e){},"u7k/":function(t,e){},wB98:function(t,e){}},["NHnr"]);